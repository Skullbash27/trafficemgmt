/* This class will be responsible for drawing the grid 
 * Layouting the streets, avenues, entry points
 * and traffic signals
 */

import javax.swing.*;
import java.util.*;
import java.awt.*;

public class TrafficGrid extends Canvas implements Runnable {
	
	int ypos[]= new int [5];
	int carwidth=6, carlength=9;
	int xpos[]= new int[5];
	int rdleft[]=new int[5];
	int rdright[] = new int[5];
	int rdtop[] = new int[5];
	int rdbottom[] = new int[5];
	
	public TrafficGrid() {
		xpos[0] = 0;
		ypos[0] = 0;
		for (int i=1; i<5; i++) {
			//light[i]= new ChangeLight();
			//carpermin[i]= new CalFlow();
			xpos[i]= xpos[i-1] + (int) (100+100*Math.random());	//middle line for vertical road
			ypos[i]= ypos[i-1] + (int) (100+100*Math.random());	//middle line for horizontal road
			//brgright[i]=xpos[i]- carlength;	//right line for vertical road
			//brgleft[i]=xpos[i]+ carlength;	//left line for vertical road
			//brgflag[i]=0;					//intersection not occupied
		}
		for(int k=1; k<4; k++) {
			rdtop[k] = ypos[k-1] + carwidth;
			rdbottom[k]= ypos[k-1]- carwidth;
			rdleft[k] = xpos[k-1]- carwidth;
			rdright[k] = xpos[k-1]+ carwidth; 
		}
		rdtop[0] = 0;		//entrance points
		rdbottom[0] = 0;
		rdleft[0]=0;
		rdright[0]=0;
	}
	
	Image offscreen;
	Dimension offscreensize;
	Graphics offgraphics;
	
	public synchronized void paint(Graphics g) {
		Dimension d = getSize();
		if ((offscreen == null) || (d.width != offscreensize.width) || (d.height != offscreensize.height)) {
				//for window resizing
				offscreen = createImage(d.width, d.height);
				offscreensize = d;
				offgraphics = offscreen.getGraphics();
		}
		offgraphics.setColor(Color.black);
		offgraphics.fillRect(0, 0, d.width, d.height);
		paintRoad(offgraphics);
		g.drawImage(offscreen, 0, 0, null);
	}
	
	public void paintRoad(Graphics g){
		Dimension d = getSize();
		g.setColor(Color.gray);
		
		for(int i = 1; i<4; i++) {
			g.fillRect(xpos[i]-3*carwidth, 0, 6*carwidth, d.height);
			g.fillRect(0, ypos[i]-3*carwidth, 6*carwidth, d.height);
		}
		
		
		/*for(int k=1; k<4; k++){
			g.drawLine(rdleft[k], 0, rdleft[k], rdbottom);
			g.drawLine(rdleft[k], rdtop, rdleft[k], d.height);
			g.drawLine(rdright[k], 0, rdright[k], rdbottom);
			g.drawLine(rdright[k], rdtop, rdright[k], d.height);
			g.drawLine(rdright[k-1], rdtop, rdleft[k], rdtop);
			g.drawLine(rdright[k-1], rdbottom, rdleft[k], rdbottom);
		}
		g.drawLine(rdright[3], rdbottom, d.width, rdbottom);
		g.drawLine(rdright[3], rdtop, d.width, rdtop);*/
	}
	
	public void run() {
		while (true) {
			repaint();
			try {
				Thread.sleep(50);
			} catch (InterruptedException e) {
				break;
			}
		}
	}
	
}
